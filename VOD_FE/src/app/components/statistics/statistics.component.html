<div class="container-fluid">
    <div class="header-container-1 justify-content-center">
        <div class="row d-flex justify-content-center align-items-center">
            <div class="header-title-content flex col-lg-8 col-md-7 col-sm-6">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="16" cy="16" r="16" fill="#F1F1F1" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M9.5 23H23V22H10V9H9V22.5L9.5 23ZM11 20.5V12.5L11.5 12H13.5L14 12.5V20.5L13.5 21H11.5L11 20.5ZM13 20V13H12V20H13ZM19 10.5V20.5L19.5 21H21.5L22 20.5V10.5L21.5 10H19.5L19 10.5ZM21 11V20H20V11H21ZM15 20.5V14.5L15.5 14H17.5L18 14.5V20.5L17.5 21H15.5L15 20.5ZM17 20V15H16V20H17Z"
                        fill="#767676" />
                </svg>
                <div class="header-title">
                    <div class="d-flex align-items-center">
                        <span class="bold-header-text me-1 me-md-2">Analytics | </span>
                        <span class="non-bold-header-text d-md-inline-block">Your video statistics</span>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-5 col-sm-6 header-create-btn-content justify-content-end"></div>
        </div>
    </div>

    <div class="header-container mt-4">
        <div class="row">
            <div class="col-12 text-left">
                <span class="package"><b style="color: black;">You have activated the package:
                        {{analyticsData&&analyticsData.subscription?analyticsData.subscription.subscriptionPlan.name:
                        'Free'}} |</b></span>
                <span routerLink="/profile" class="change-package cursor-pointer" style="color: #811630;"> Change
                    package</span>
            </div>
        </div>
        <div class="row mt-5">
            <div class="col-lg-6 p-0 d-flex justify-content-start align-items-center">
                <span class="storage-text">Storage</span>
            </div>
            <div class="col-lg-6 d-flex justify-content-end align-items-center mt-0">
                <span class="storage-descrip storage-descrip-large">{{((usedStorage/totalStorage)*100).toFixed(2)}}% used of
                    {{totalStorage}}GB</span>
            </div>
            <div class="col-12 d-lg-none d-flex justify-content-start align-items-center mt-1">
                <span class="storage-descrip">2.52% used of {{totalStorage}}GB</span>
            </div>
        </div>
        <div class="row">
            <div class="progress mt-2 !p-0">
                <div class="progress-bar" role="progressbar" [style.width]="storagePercentage() + '%'"
                    [attr.aria-valuenow]="storagePercentage()" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
        </div>
        <div class="row mt-5">
            <div class="col-lg-6 p-0 d-flex justify-content-start align-items-center">
                <span class="storage-text">Bandwidth</span>
            </div>
            <div class="col-lg-6 d-flex justify-content-end align-items-center mt-0 mt-lg-0">
                <span class="storage-descrip storage-descrip-large">{{((bandwidth/totalBandwidth)*100).toFixed(2)}}% Consumed in the month | {{totalBandwidth}}GB</span>
            </div>
            <div class="col-12 d-lg-none d-flex justify-content-start align-items-center mt-1">
                <span class="storage-descrip">29.04% Consumed in the month | 93.55 GB</span>
            </div>
        </div>
        <div class="row">
            <div class="progress mt-2 !p-0">
                <div class="progress-bar" role="progressbar" [style.width]="storagePercentage2() + '%'"
                    [attr.aria-valuenow]="storagePercentage2()" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <div class="col-12 p-0 d-flex justify-content-start align-items-center mt-4">
                <span class="storage-descrip">The data plan (bandwidth and uploads number) is renewed on:
                    {{analyticsData && getDate(analyticsData.from)}}</span>
            </div>
        </div>
    </div>
    <!-- <div class="header-container mt-4 color-light-blue">
        <div class="filter-between-pixes">
            <div class="row align-items-center filter-container filter-row flex-sm-row">
                <div class="col-md-5 col-sm-12 d-flex justify-content-start align-items-center mb-2 mb-sm-0 custom-col">
                    <label for="date-filter" class="form-label me-2">Filter:</label>
                    <select id="date-filter" class="form-select form-select-sm me-2" [(ngModel)]="selectedFilter" 
                    (change)="selectedFilter !== 'dateRange' ? applyFilter() : null">
                        <option value="dateRange">Date Range</option>
                        <option value="today">Today</option>
                        <option value="yesterday">Yesterday</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                    </select>
                </div>
                <div class="col-md-5 col-sm-12 d-flex justify-content-start align-items-center mb-2 mb-sm-0 custom-col" *ngIf="selectedFilter === 'dateRange'">
                    <label for="from-input" class="form-label me-2">From:</label>
                    <input id="from-input" type="date" class="form-control me-2" [(ngModel)]="fromDate">
                    <label for="to-input" class="form-label me-2">To:</label>
                    <input id="to-input" type="date" class="form-control" [(ngModel)]="toDate">
                </div>
                <div class="col-md-2 col-sm-6 mt-sm-3 mt-md-0 col-6 justify-content-center align-items-center mt-3 mt-sm-0 filter-btn-select-container custom-col">
                    <button class="btn btn-primary filter-btn" (click)="applyFilter()">Apply Filter</button>
                </div>
             
            </div>
            
        </div>
        
    </div> -->

    <div class="header-container mt-4 color-light-blue">
        <div class="filter-between-pixes">
          <div class="row align-items-center filter-container filter-row g-2">
            <!-- Filter Dropdown -->
            <div class="col-12 col-md-5 d-flex flex-column flex-md-row align-items-start align-items-md-center mb-2 mb-md-0 custom-col">
              <label for="date-filter" class="form-label me-2 mb-1 mb-md-0">Filter:</label>
              <select
                id="date-filter"
                class="form-select form-select-sm me-0 me-md-2"
                [(ngModel)]="selectedFilter"
                (change)="selectedFilter !== 'dateRange' ? applyFilter() : null"
              >
                <option value="dateRange">Date Range</option>
                <option value="today">Today</option>
                <option value="yesterday">Yesterday</option>
                <option value="week">This Week</option>
                <option value="month">This Month</option>
              </select>
            </div>
      
            <!-- Date Range Inputs -->
            <div
              class="col-12 col-md-5 d-flex flex-column flex-md-row align-items-start align-items-md-center mb-2 mb-md-0 custom-col"
              *ngIf="selectedFilter === 'dateRange'"
            >
              <label for="from-input" class="form-label me-2 mb-1 mb-md-0">From:</label>
              <input
                id="from-input"
                type="date"
                class="form-control me-0 me-md-2 mb-2 mb-md-0"
                [(ngModel)]="fromDate"
                style="min-width: 150px"
              />
              <label for="to-input" class="form-label me-2 mb-1 mb-md-0">To:</label>
              <input
                id="to-input"
                type="date"
                class="form-control"
                [(ngModel)]="toDate"
                style="min-width: 150px"
              />
            </div>
      
            <!-- Apply Button -->
            <div class="col-12 col-md-2 d-flex justify-content-center justify-content-md-start align-items-center mt-2 mt-md-0 custom-col">
              <button class="btn btn-primary filter-btn w-100 w-md-auto" (click)="applyFilter()">Apply Filter</button>
            </div>
          </div>
        </div>
      </div>
     
    <div class="header-container">
          <!-- Show heading indicating applied filter -->
       <div *ngIf="appliedFilter" class="col-md-12 text-center mt-3">
        <h4>{{ appliedFilter }}</h4>
    </div>
        <div class="row">
            <div class="col-md-6 justify-content-center">
                <div class="header-container justify-content-center graph-container-1">
                    <canvas #views></canvas>
                </div>
            </div>
            <div class="col-md-6 justify-content-end">
                <div class="header-container justify-content-center graph-container-1">
                    <canvas #bandConsumed></canvas>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-6 justify-content-center">
                <div class="header-container justify-content-center graph-container-1">
                    <canvas #averageTime></canvas>
                </div>
            </div>
            <div class="col-md-6 justify-content-end">
                <div class="header-container justify-content-center graph-container-1">
                    <canvas #totalTime></canvas>
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-6 col-md-3 small-margin">
                <div class="justify-content-center max-[375px]:h-[200px] graph-container-2">
                    <canvas #doughnutChart></canvas>
                </div>
            </div>
            <div class="col-6 col-md-3 small-margin">
                <div class="justify-content-center max-[375px]:h-[200px] graph-container-2">
                    <canvas #totalTimeCircleChart></canvas>
                </div>
            </div>
            <div class="col-6 col-md-3 small-margin">
                <div class="justify-content-center max-[375px]:h-[200px] graph-container-2">
                    <canvas #averageTimeDoughnut></canvas>
                </div>
            </div>
            <div class="col-6 col-md-3 small-margin">
                <div class="justify-content-center max-[375px]:h-[200px] graph-container-2">
                    <canvas #bandConsumedDoughnut></canvas>
                </div>
            </div>
        </div>
        <div class="row mt-4 graph-container-1">
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Channel</th>
                            <th>Total Time (Seconds)</th>
                            <th>Average Time (Seconds)</th>
                            <th>Band Consumed (Mb)</th>
                            <th>Unique Views</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of combinedData">
                            <td>{{ item['Title'] }}</td>
                            <td>{{ item['channelName'] }}</td>
                            <td>{{ item['Total Time'] }}</td>
                            <td>{{ item['Average Time'] }}</td>
                            <td>{{ item['Band Consumed'] }}</td>
                            <td>{{ item['uniqueViews'] }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
    </div>
</div>



